На первый взгляд код корректный и он отработает 
Но, если мы перед закрытием канала решим туда что-нибудь записать, то мы сможем вычитать это значение
В функции IsCLosed нужно проверять факт закрытия/открытия канала

На заметку:
Проверка канала на закрытие/открытие редко встречается - основной вариант это идти range до тех пор пока не вычитаем все значения